---
title: "06-visualize-residual-morphospace"
author: "Ariel Marcy"
date: "9/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '../eco-rodents')
```

# Test biome partitioning 
1) Explore morphospace differences in PCA of size-less shape (residuals)

2) Assess patterns in skull shape variation along PC1 & 2 axes that could be related to adaptation

### Load packages, functions, and data
Tree, mean shape, and metadata for phylogenetic analyses come from the allometry rodents script 04. 
```{r message = FALSE}
library(geomorph)
library(dplyr)
library(geiger)
source("../Functions/utilities.R")  # custom functions
load(file = "../Data/Processed/03-sm-PCA-with-color.rda")
load(file = "../Data/Processed/04-sm-data-with-traits.rda")
load(file = "../Data/Processed/allometry_rodents_04-phylo-data.rda")  # phylogenetic tree from Allometry Rodents paper / repo
load(file = "../Data/Processed/05-residual-data.rda")
```

### Remove aquatic carnivores because differences are known
Two species: *Hydromys_chrysogaster* (H_chr) and "Xeromys_myoides" (X_myo)
```{r}
# no carnivores = nc
nc.info.means.tree <- info.means.tree[c(-2, -36), ]  # metadata
nc.residuals <- Allom.all.plus.consensus[, , c(-2, -36)]  # shape data
nc.alpha.cols <- alpha.cols[c(-2,-36)]  # colors
nc.alpha.pch <- alpha.pch[c(-2,-36)]  # pch synbols

# For legend
carn <- c(which(names(phylo.cols) == "H_chr"), which(names(phylo.cols) == "X_myo"))
nc.phylo.cols <- phylo.cols[-carn]  # colors
nc.phylo.pch <- phylo.pch[-carn]  # pch synbols
nc.phylo.names <- phylo.names[-carn]  # names
```

### Plot residuals
```{r}
nc.res.PCA <- plotTangentSpace(nc.residuals, groups = nc.alpha.cols)
PlotPCA(nc.res.PCA, 1, 2, nc.alpha.cols, nc.alpha.pch)
legend("bottomright", nc.phylo.names, col = nc.phylo.cols, pch = nc.phylo.pch, pt.bg = nc.phylo.cols, cex = .57, pt.cex = 1.5, ncol = 2)
```

## Plot warp grids of PC1